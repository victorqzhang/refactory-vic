<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Platform API &mdash; Mercury 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Post Office API" href="post-office-api.html" />
    <link rel="prev" title="Reserved Route Names" href="route-names.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Mercury
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Libraries and Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="compatability.html">Compatability</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="How-tos.html">Pragmatic Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-properties.html">Application Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="route-names.html">Reserved Route Names</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Platform API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-platform-classes-and-utilities">Basic platform classes and utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#eventenvelope">EventEnvelope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Platform API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register-a-public-function">Register a public function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register-a-private-function">Register a private function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#release-a-function">Release a function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-the-cloud">Connect to the cloud</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="post-office-api.html">Post Office API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest-automation.html">Rest Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax-rs.html">JAX-RS and WebServlets</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectors.html">Cloud Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicast.html">Multicast</a></li>
<li class="toctree-l1"><a class="reference internal" href="additonal-features.html">Additonal Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="version-control.html">Version Control</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mercury</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Platform API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/platform-api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="platform-api">
<h1>Platform API<a class="headerlink" href="#platform-api" title="Permalink to this headline"></a></h1>
<p>Mercury has a small set of API for declaring microservices functions and sending events to functions.</p>
<section id="basic-platform-classes-and-utilities">
<h2>Basic platform classes and utilities<a class="headerlink" href="#basic-platform-classes-and-utilities" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Platform</span></code> - the platform class is a singleton object for managing life cycle of functions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PostOffice</span></code> - a singleton object for sending events to functions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ServerPersonality</span></code> - a singleton object for setting the personality or type of an application unit. e.g. REST, WEB, APP, RESOURCES and DEVOPS</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AppConfigReader</span></code> - a singleton object for reading application.properties that can be overriden by run-time parameters or environment variables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CryptoApi</span></code> - a convenient crypto library for common cryptographic tasks like hashing, AES and RSA encryption and digital signing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ManagedCache</span></code> - a useful in-memory cache store.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MultiLevelMap</span></code> - a HashMap wrapper that allows you to retrieve item using the dot-bracket syntax. e.g. map.getElement(“hello.world[3]”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Utility</span></code> - a convenient singleton object for commonly methods such as UTC time string, UTF, stream, file, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleMapper</span></code> - a preconfigured JSON serializer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SimpleXmlParser</span></code> and <code class="docutils literal notranslate"><span class="pre">SimpleXmlWriter</span></code> - efficient XML serializer.</p></li>
</ol>
</section>
<section id="eventenvelope">
<h2>EventEnvelope<a class="headerlink" href="#eventenvelope" title="Permalink to this headline"></a></h2>
<p>EventEnvelope is a vehicle for storing and transporting an event that contains headers and body. <code class="docutils literal notranslate"><span class="pre">headers</span></code> can be used to carry parameters and <code class="docutils literal notranslate"><span class="pre">body</span></code> is the message payload. Each event should have either or both of headers and body. You can set Java primitive, Map or PoJo into the body.</p>
<p>Mercury automatically performs serialization and deserialization using the EventEnvelope’s <code class="docutils literal notranslate"><span class="pre">toBytes()</span></code> and <code class="docutils literal notranslate"><span class="pre">load(bytes)</span></code> methods. For performance and network efficiency, it is using Gson and MsgPack for serialization into Map and byte array respectively.</p>
<p>EventEnvelope is used for both input and output. For simple use cases in asynchronous operation, you do not need to use the EventEnvelope. For RPC call, the response object is an EventEnvelope. The service response is usually stored in the “body” in the envelope. A service may also return key-values in the “headers” field.</p>
<p>Mercury is truly schemaless. It does not care if you are sending a Java primitive, Map or PoJo. The calling function and the called function must understand each other’s API interface contract to communicate properly.</p>
</section>
<section id="id1">
<h2>Platform API<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<p>Obtain an instance of the platform object</p>
<p><code class="docutils literal notranslate"><span class="pre">Platform</span> <span class="pre">platform</span> <span class="pre">=</span> <span class="pre">Platform.getInstance();</span></code></p>
</section>
<section id="register-a-public-function">
<h2>Register a public function<a class="headerlink" href="#register-a-public-function" title="Permalink to this headline"></a></h2>
<p>To register a function, you can assign a route name to a function instance. You can also set the maximum number of concurrent workers in an application instance. This provides vertical scalability in addition to horizontal scaling by Docker/Kubernetes.</p>
<p>To create a singleton function, set instances to 1.</p>
<p><code class="docutils literal notranslate"><span class="pre">platform.register(String</span> <span class="pre">route,</span> <span class="pre">LambdaFunction</span> <span class="pre">lambda,</span> <span class="pre">int</span> <span class="pre">instances)</span> <span class="pre">throws</span> <span class="pre">IOException;</span></code></p>
<blockquote>
<div><p>For example:</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">platform.register(&quot;hello.world&quot;,</span> <span class="pre">echo,</span> <span class="pre">20);</span></code></p>
</section>
<section id="register-a-private-function">
<h2>Register a private function<a class="headerlink" href="#register-a-private-function" title="Permalink to this headline"></a></h2>
<p>Public functions are advertised to the whole system while private functions are encapsulated within an application instance.</p>
<p>You may define your function as private if it is used internally by other functions in the same application instance.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">platform</span><span class="p">.</span><span class="na">registerPrivate</span><span class="p">(</span><span class="n">String</span> <span class="n">route</span><span class="p">,</span> <span class="n">LambdaFunction</span> <span class="n">lambda</span><span class="p">,</span> <span class="kt">int</span> <span class="n">instances</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="release-a-function">
<h2>Release a function<a class="headerlink" href="#release-a-function" title="Permalink to this headline"></a></h2>
<p>A function can be long term or transient. When a function is no longer required, you can cancel the function using the “release” method.</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">release(String</span> <span class="pre">route)</span> <span class="pre">throws</span> <span class="pre">IOException;</span></code></p>
</section>
<section id="connect-to-the-cloud">
<h2>Connect to the cloud<a class="headerlink" href="#connect-to-the-cloud" title="Permalink to this headline"></a></h2>
<p>You can write truly event-driven microservices as a standalone application. However, it would be more interesting to connect the services together through a network event stream system.</p>
<p>To do this, you can ask the platform to connect to the cloud.</p>
<p><code class="docutils literal notranslate"><span class="pre">platform.connectToCloud();</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="route-names.html" class="btn btn-neutral float-left" title="Reserved Route Names" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="post-office-api.html" class="btn btn-neutral float-right" title="Post Office API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>